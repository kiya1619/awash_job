{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    {% if messages %}
  <div class="mt-3">
    {% for message in messages %}
      {% if message.tags == "error" %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
      {% elif message.tags == "warning" %}
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
      {% elif message.tags == "success" %}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
      {% else %}
        <div class="alert alert-info alert-dismissible fade show" role="alert">
      {% endif %}
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
  </div>
{% endif %}
  <h2 class="mb-4">Promotion List</h2>

  <div class="mb-3">
    <a href="{% url 'promotion' %}" class="btn btn-primary">Add Promotion</a>
  </div>

  {% if promotions %}
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Employee Name</th>
        <th>Employee ID</th>
        <th>Old Grade</th>
        <th>New Grade</th>
        <th>Promotion Date</th>
        <th>Remarks</th>
        <th>Remove Promotion</th>
      </tr>
    </thead>
    <tbody>
      {% for promo in promotions %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ promo.employee.full_name }}</td>
        <td>{{ promo.employee.employee_id }}</td>
        <td>{{ promo.old_grade|default:"-" }}</td>
        <td>{{ promo.new_grade }}</td>
        <td>{{ promo.promoted_at|date:"M d, Y" }}</td>
        <td>{{ promo.remarks|default:"-" }}</td>
        <td>
          <form method="post" action="{% url 'delete_promotion' promo.id %}" onsubmit="return confirm('Are you sure you want to remove this promotion?');">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger btn-sm">Delete</button>
          </form>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No promotions recorded yet.</p>
  {% endif %}
</div>
{% endblock %}
